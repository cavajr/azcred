<div class="row animated fadeIn">
  <div class="col-12">
    <div class="card">
      <div class="card-header bg-megna">
        <strong>Filtros</strong>
      </div>
      <form class="form-vertical" autocomplete="off" (ngSubmit)="pesquisar()">
        <div class="card-body">
          <div class="form-group">
            <label for="input-nome">Nome</label>
            <input
              type="text"
              class="form-control"
              id="input-nome"
              placeholder="Digite o nome"
              name="nome"
              [(ngModel)]="filtro.nome"
            />
          </div>
        </div>
        <div class="card-footer">
          <button class="btn btn-sm btn-outline-success" type="submit">
            <i class="fa fa-search-plus"></i> Pesquisar
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <strong>Listagem</strong>
        <button
          routerLink="/corretores/novo"
          [disabled]="!auth.temPermissao('CADASTRAR_CORRETOR')"
          class="btn btn-sm btn-primary botao-card-direito"
        >
          <i class="fa fa-plus"></i> Novo
        </button>
      </div>
      <div class="card-body">
        <p-table
          [value]="corretores"
          [responsive]="true"
          [paginator]="true"
          [rows]="filtro.itensPorPagina"
          [lazy]="true"
          [loading]="loading"
          [totalRecords]="totalRegistros"
          (onLazyLoad)="aoMudarPagina($event)"
          #tabela
        >
          <ng-template pTemplate="header">
            <tr>
              <th style="width: 3em"></th>
              <th style="width: 85px; text-align: center">CÓDIGO</th>
              <th style="width: 30%; text-align: center">CPF/CNPJ</th>
              <th style="width: 60%">Nome</th>
              <th style="width: 120px; text-align: center;">Ações</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-corretor>
            <tr>
              <td style="width: 3em">
                <span
                  *ngIf="corretor.ativo == 'S'"
                  class="badge badge-pill badge-success"
                  ><i class="fa fa-check"></i
                ></span>
                <span
                  *ngIf="corretor.ativo == 'N'"
                  class="badge badge-pill badge-danger"
                  ><i class="fa fa-close"></i
                ></span>
              </td>
              <td style="width: 85px; text-align: right;">
                <span class="ui-column-title">CÓDIGO</span> {{ corretor.id }}
              </td>
              <td style="width: 30%; text-align: center;">
                <span class="ui-column-title">CPF/CNPJ</span> {{ corretor.cpf }}
              </td>
              <td>
                <span class="ui-column-title">Nome</span> {{ corretor.nome }}
              </td>
              <td style="width: 120px; text-align: center;">
                <button
                  pButton
                  class="ui-button-warning"
                  icon="pi pi-pencil"
                  pTooltip="Editar"
                  tooltipPosition="top"
                  [routerLink]="['/corretores', corretor.id]"
                  [disabled]="!auth.temPermissao('CADASTRAR_CORRETOR')"
                ></button>

                <button
                  pButton
                  style="margin-left: 5px"
                  class="ui-button-info"
                  icon="fa fa-table"
                  pTooltip="Comissão"
                  *ngIf="corretor.taxa == 'E'"
                  tooltipPosition="top"
                  [routerLink]="['/corretores', corretor.id, 'comissao']"
                  [disabled]="!auth.temPermissao('COMISSAO_CORRETOR')"
                ></button>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="5">Nenhum corretor encontrado</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
</div>
